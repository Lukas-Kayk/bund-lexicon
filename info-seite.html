<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>BUND-Lexikon · Info</title>
  <base href="/"/>
  <link rel="icon" type="image/x-icon" href="favicon.ico"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="assets/css/styles.css"/>
</head>
<body>
  <!-- ===== Header (shared with Kategorien/Impressum) ===== -->
  <header class="site-header">
    <div class="container header-inner" role="navigation" aria-label="Site navigation">
      
      <!-- Brand -->
      <a class="brand" href="index.html">
        <span class="brand-badge" aria-hidden="true">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M4 10.5C4 7.462 6.462 5 9.5 5h5A5.5 5.5 0 0 1 20 10.5v3A5.5 5.5 0 0 1 14.5 19h-5A5.5 5.5 0 0 1 4 13.5v-3Z" fill="white"/>
          </svg>
        </span>
        <span class="brand-title">BUND-Lexikon</span>
      </a>

      <div class="spacer"></div>

      <!-- Navigation toolbar -->
      <nav class="toolbar" aria-label="Navigation">
        <!-- Back button -->
        <a id="back-btn" class="icon-btn" href="javascript:history.back()" aria-label="Back">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </a>
        <!-- Home button -->
        <a class="icon-btn" href="kategorien.html" aria-label="Home">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M3 10.5l9-7 9 7V20a2 2 0 0 1-2 2h-4a2 2 0 0 1-2-2v-4H9v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-9.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </a>
      </nav>
    </div>
  </header>

  <!-- ===== Main content ===== -->
  <main class="container">
    <!-- Page heading -->
    <div class="page-heading">
      <h1 id="titel">Info</h1>
      <span id="subline" class="page-sub">Details, Bild &amp; Quelle</span>
    </div>

    <!-- Content: text + image -->
    <section class="content">
      <!-- Info text card -->
      <article class="card prose">
        <div class="title-block">
          <h3 id="name">—</h3>
          <h4 id="Uname">—</h4>
        </div>
        <div id="infoText">—</div>
      </article>

      <!-- Image + source card -->
      <aside class="card">
        <figure class="media">
          <div class="thumb">
            <img id="bild-info" src="assets/img/placeholder.png" alt=""/>
          </div>
          <figcaption id="quelle">—</figcaption>
        </figure>
      </aside>
    </section>

    <!-- Footer with Impressum link -->
    <footer class="page-footer">
      <a class="link-btn" href="impressum.html">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <path d="M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10Zm-8 9a8 8 0 1 1 16 0v1H4v-1Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span>Impressum</span>
      </a>
    </footer>
  </main>

  <!-- ===== Scripts ===== -->
  <script src="assets/js/script.js"></script>
  <script>
    // Helper: get query parameters
    function getParam(name, url=window.location.href){ 
      try { return new URL(url).searchParams.get(name); } 
      catch { return null; } 
    }

    document.addEventListener('DOMContentLoaded', async function(){
      // Try to call fetchData() if defined
      try { if (typeof fetchData === 'function') await fetchData(); } 
      catch(e){ console.warn('fetchData() missing or failed', e); }

      // Get params
      const url = window.location.href;
      const kategorie = (typeof getQueryParam === 'function') ? getQueryParam('kategorie', url) : getParam('kategorie', url);
      const info = (typeof getQueryParam === 'function') ? getQueryParam('info', url) : getParam('info', url);

      // Find matching object in data map
      let infoObject = window.KATEGORIEN_DATA_MAP?.[kategorie]?.find(category => {
        if (category?.art) return category.art.some(a => a.name === info);
        return category?.name === info;
      });
      if (infoObject?.art) infoObject = infoObject.art.find(x => x.name === info);
      infoObject = infoObject || { name: info || 'Unbekannt', text: '', lat: '', quelle: '', bild: '' };

      // Update DOM
      document.getElementById('titel').textContent = infoObject.name || 'Info';
      document.getElementById('name').textContent = infoObject.name || '—';
      document.getElementById('Uname').textContent = infoObject.lat || '';
      document.getElementById('infoText').textContent = infoObject.text || '';
      document.getElementById('quelle').textContent = infoObject.quelle || '';
      const bild = document.getElementById('bild-info');
      if (infoObject.bild) {
        bild.src = infoObject.bild;
        bild.alt = infoObject.quelle || infoObject.name || 'Bild';
      } else {
        bild.alt = 'Kein Bild verfügbar';
      }

      // Hide back button if no referrer
      const backBtn = document.getElementById('back-btn');
      const hasRef = document.referrer && new URL(document.referrer).origin === window.location.origin;
      if (!hasRef) backBtn?.classList.remove('hidden');
    });
  </script>
</body>
</html>
